# **Instructions**

> Для выполнения следующих шагов необходим `Docker`!

Необходимо клонировать ветку `PB-33`, либо перейти в неё, если репозиторий уже клонирован. Это можно выполнить следующими командами:
```
git clone https://github.com/moevm/os_profiling.git -b PB-33
```
```
git checkout PB-33
git pull 
```

- ### **Yocto/Buildroot**
    Все дальнейшие шаги происходят в директории `<image_name>-build`.
    Тут и далее `image_name` может принимать только одно из следующих значений: `yocto`, `buildroot`.
    1. Чтобы создать образ требудется запустить скрипт `create_image.sh` командой:
        ```
        bash create_image.sh <version>
        ```
        Значение аргумента `<version>` по умолчанию -- `unselected`.
        **Этот скрипт предусматривает возможность пересборки, так как он учитывает существующий образ с названием `<image_name>-image` или начинающимся на такую же последовательность. То есть образ с соответствующим названием будет удалён, а далее собран новый.**
        
        **В данный момент скрипт не поддерживает возможное существование нескольких образов соответсвующих паттерну. То есть может существовать только 1 образ `yocto` и 1 образ `buildroot`. Аналогично работает и скрипт из следующего шага.**
    2.  После удачной сборки образа, можно запустить контейнер с помощью скрипта `run_container.sh`:
        ```
        bash run_container.sh
        ```
        **Важно, что скрипт запускает образ, название которого соответсвует паттерну из прошлого шага.**
    
    3. Как только контейнер будет запущен, будет предоставлен доступ к его файловой системе. Это можно понять по идентификатору пользователя, он будет выглядить так: `<image_name>_user@<container_id>`. Тут же можно найти директорию `scripts`, тут будут храниться данные\файлы с хоста -- volume.
    Все последующие шаги происходят внутри контейнера.
    
    4. Для того, чтобы запустить сборку образа необходимо запустить скрипт `building.sh`:
        ```
        bash ./scripts/building.sh
        ```
        
        Запуск образа `Yocto` происходит с помощью команды:
        ```
        runqemu qemux86-64
        ```
        
        Запустить образ `Buildroot` не выйдёт, результатом сборки является файл -- `/buildroot/output/images/sdcard.img`.
        
    5. Чтобы выйти из контейра можно использовать сочетание клавиш `Ctrl + D` в терминале.
        **При выходе контейнер автоматически удаляется, то есть для повторного пользования необходимо будет начать с шага №3.**
        
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    