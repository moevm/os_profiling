### Instruction -- Step-by-Step Guide for Conducting the Experiment
1) Чтобы собрать образ нужно в текущей директории выполнить команду: `docker build -t my-http-server .`  

2) Чтобы запустить n серверов на портах от указанного до n-1 нужно выполнить команду `./scripts/start_servers.sh порт_с_которого_начнется_итерация количество_серверов`  

3) Чтобы поменять фладельца созданной папки с root на текущего пользователя нужно ввести команду `./scripts/make_folders_public.sh` -- программа попросит пароль от вашего sudo 

4) Теперь нужно переместить в текущую папку sstate-cache

5) Чтобы распределить кэш из sstate-cache выполнить команду `python3 cache_packaging.py`

6) Чтобы автоматически составить то, что нужно вставить в local.conf файл на pc с целевой сборкой нужно выполнить команду `python3 compose_local_conf.py`

7) Вы получили логи в консоль - их нужно скопировать и передать на pc с целевой сборкой [я обычно записываю в txt файл на какой-то север, а потом через браузер просто открываю этот файл на pc с целевой сборкой копирую содержимое и вставляю в `local.conf`]

8) Важно не забыть задать задать параметры хэш сервера, программа выдает  
`BB_HASHSERVE_UPSTREAM = "<ip>:<port>"` -- сделано так, поскольку ни ip ни порт заранее не узнать, ведь хэш сервер в рамках эксперимента может быть запущен где угодно

9) На pc с целевой сборкой вставляем содержимое файла (который мы передавали на этот pc, в котором логи выполнения П.6) и меняем `BB_HASHSERVE_UPSTREAM = "<ip>:<port>"` на реальный адрес хэш сервера

10) Запускаем сборку на pc с целевой сборкой как обычно: `bitbake <target>`

11) После окончания сборки можно отключать хэш сервер: `CTRL + C`

12) Отключать кэш сервера, путем остановки и удаления docker контейнеров: `./scripts/rm_containers.sh`

13) Удаляем все серверные папки с распределенным кэшем: `./scripts/rm_server_folders.sh`


### Results
Результаты будут помещаться в папку `./result/`
Например, результат сборки если запущен только один сервер с кэшем представлен в `./result/stats_1_server.png`


### How to run hash server
Локация хэш сервера не важна (я экспериментировал и поднимал хэш сервер на стороннем pc - отличное работает).

Чтобы запустить hash сервер нужно:
1) репозиторий poky, для того, чтобы активировать окружение bitbake
2) выполнить `source oe-init-build-env` -- активировать окружение bitbake
3) зайти в любую директорию (не важно какую - но я бы создал новую, чтобы сторонними скриптами не сломать сервер)
4) выполнить команду `bitbake-hashserv -r -b <ip>:<port>`  --  флаг `-b` позволяет указать порт и ip, если не заполнить поле <ip> и сделать `:<port>`, то сервер запустится на local host.

Что касается настройки - это все, однако в файле конфигурации `local.conf` **целевой** сборки нужно указать этот хэш-сервер примерно так:

```sh
BB_HASHSERVE = "auto"  
BB_HASHSERVE_UPSTREAM = "<ip>:<port>"  
BB_SIGNATURE_HANDLER = "OEEquivHash" 
```