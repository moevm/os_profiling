## Инструкция по применению патча

1. Переместить патч cachefiles.patch в директорию poky/meta/classes-global/.
2. Применить патч: patch -p1 sstate.bbclass < cachefiles.patch
3. Запустить сборку


## Принцип работы
В файле cache_server.py реализован функционал кэш-сервера, на нем реализован REST API, который позволяет серверу сообщать клиенту о том, какие файлы он имеет. В остальном кэш-сервер работает как и раньше. 

После применения патча к файлу sstate.bbclass логика опроса зеркал изменяется, и становится следующей:
Сначала происходит запрос к серверу, в ответ сервер сообщает, какие файлы с кэшем у него есть, после чего bitbake сопоставляет задачи имеющимся файлам, и найденные setscene-задачи переиспользует. Данная проверка происходит практически мгновенно.

## Шаги по включению кэш-сервера и сборки
1. Применяем патч по инструкции выше
2. Кладём файл cache_server.py туда, где хотим запустить кэш-сервер (туда, где лежат файлы с кэшем). 
3. Запускаем кэш-сервер следующим образом: `python3 cache_server.py`. По умолчанию кэш-сервер запускается на 8000 порту.
4. Запускаем сборку (с настроенными в local.conf зеркалами).



