
services:
  yocto_project:
    container_name: yocto_project
    image: yocto-image
    build:
      context: ../../
      dockerfile: ./src/yocto-build/Dockerfile
      target: base
      args:
        - CODENAME
        - CORE
        - REQS_ARG
        - UID=1000
        - GID=1000
        - LANG=en_US.UTF-8
        - LC_ALL=en_US.UTF-8
        - YOCTO_INSTALL_PATH=/home/yocto_user/project
    cap_add:
      - SYS_PTRACE
    security_opt:
      - seccomp:unconfined
    privileged: true
    environment:
      - STAGE_VAR
      - YOCTO_COMMIT_HASH=4b07a5316ed4b858863dfdb7cab63859d46d1810
    volumes:
      - ./assembly:/home/yocto_user/project/assembly
      - /sys/kernel/debug:/sys/kernel/debug
