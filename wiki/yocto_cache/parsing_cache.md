# Кэширование парсинга рецептов в BitBake
BitBake оптимизирует процесс сборки, используя механизм кэширования данных, полученных при парсинге рецептов.
## Как происходит кэширование парсинга
- Сохранение переменных: BitBake сохраняет значения интересующих его переменных, которые действительно используются при сборке (перехватывая вызовы `getVar`) и не сохраняет остальную информацию. Опыт показывает, что повторный парсинг метаданных быстрее, чем запись и повторная загрузка всей информации на диск. 
- Проверка валидности кэша: 
	- если файл не существует или его время изменения (mtime) отличается от сохраненного в кэше, кэш считается недействительным
	- для каждого зависимого файла проверяется, существует ли он и не изменилось ли его время изменения. Если зависимый файл отсутствует или изменился, кэш считается недействительным.
	- если у файла есть контрольные суммы, проверяется, существуют ли файлы из списка контрольных сумм и не изменились ли они. Если есть несоответствия, кэш считается недействительным.
	- сравниваются текущие дополнения (appends) с сохраненными в кэше. Если они отличаются, кэш считается недействительным.
- `bb_cache.dat` используется для хранения кэша 
- Если кэш валиден, BitBake загружает кэшированную информацию о рецепте вместо повторного парсинга, что значительно экономит время.

## Эксперимент с изменением рецептов
### Цель эксперимента
Проверить поведение системы при изменении рецепта, от которого зависят многие другие рецепты, и рецепта, от которого не зависят другие рецепты.
### Результаты эксперимента
При изменении рецепта, от которого зависят много других рецептов, или рецепта, от которого не зависят другие рецепты, Bitbake заново не парсит никаких других рецептов кроме измененного. Для обоих случаев результат следующий:
```
Loading cache: 100% |##############################################################| Time: 0:00:00
Loaded 1844 entries from dependency cache.
Parsing recipes: 100% |############################################################| Time: 0:00:00
Parsing of 912 .bb files complete (911 cached, 1 parsed). 1844 targets, 50 skipped, 0 masked, 0 errors.
```
