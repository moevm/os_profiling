# Переменные нагрузки в Bitbake
## BB_PRESSURE_MAX_CPU
Определяет максимальный порог нагрузки на процессор, выше которого планировщик BitBake не будет запускать новые задачи (при условии, что существует хотя бы одна активная задача). Если значение не задано, нагрузка на процессор не отслеживается при запуске задач.

## BB_PRESSURE_MAX_IO
Определяет максимальный порог нагрузки ввода-вывода, выше которого планировщик BitBake не будет запускать новые задачи (при условии, что существует хотя бы одна активная задача). Если значение не установлено, давление ввода-вывода не отслеживается при запуске задач.

## BB_PRESSURE_MAX_MEMORY
Указывает максимальный порог нагрузки на память, выше которого планировщик BitBake не будет запускать новые задачи (при условии, что существует хотя бы одна активная задача). Если значение не задано, нагрузка на память не отслеживается при запуске задач.

Нехватка памяти возникает, когда время тратится на замену, восстановление страниц из кэша страниц или выполнение восстановления. Вот почему нехватка памяти наблюдается редко, но установка этой переменной может быть полезна в качестве крайней меры для предотвращения ошибок OOM, если они возникают во время сборки.

### Как Bitbake мониторит свободное место
В переменной BB_DISKMON_DIRS указаны директории, за свободным местом которых нужно следить, также указаны минимальные значения для свободного пространства (minSpace) и действия (action), которые должны вызываться при отсутствии достаточного места.
Примерно каждые 10 секунд bitbake получает информацию о текущем свободном месте директорий с помощью os.statvfs(), если это значение меньше чем minSpace, то выполняется действие action (STOPTASKS - прекращение выполнения новых задач и завершение выполнения текущих активных задач или HALT - немедленное прекращение выполнения всех задач).

## Как происходит контроль за значениями переменных нагрузки
Минимальное значение для каждой переменной - 1, максимальное - 1000000. Если установленное значение меньше минимального, сборка сразу же прекращается, а если значение больше максимального, то установленное значение просто игнорируется.

Значения текущего давления берутся из файлов /proc/pressure/cpu, /proc/pressure/io, /proc/pressure/memory.

Хотя бы раз в секунду Bitbake сохраняет текущие значения давления (prev_cpu_pressure, prev_io_pressure, prev_memory_pressure), и каждый раз при выполении новой задачи происходит подсчет текущего давления. Если хоть одно значение превысило максимальное, то bitbake продолжает выполнять активные задачи, если на данный момент таковые были, и приостанавливает запуск новых задач, пока давление не упадет ниже установленного порога.

