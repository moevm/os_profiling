# Ускорение сборки

## Ускорение сборки, используя лимит нагрузки на сеть

В самом начале сборки, после выполнения 13 задач do_fetch, устанавливается лимит нагрузки на сеть, как максимум за
период от начала сборки до выполнения 13 задач do_fetch. Затем, если в определенный момент сборки нагрузка на сеть
превышает заданный предел, то из очереди `buildable` задач в первую очередь будут взяты задачи `do_compile`, либо если
таких задач в очереди нет, то задача с наилучшим приоритетом, которая не является `do_fetch`.

Изменения, представленные в патче `add_net_limit.patch`, позволили ускорить сборку с 220m24,670s до 163m11,441s.

Патч: `add_net_limit.patch` + `add_net_buildstats.patch`.

## Ускорение сборки, используя граф зависимостей

Для подсчета приоритетов задач был добавлен учет количества детей у задачи. Чем больше детей у задачи, тем выше ее
приоритет. Информация о детях задачи берется из файла `task-children.txt`. Данный файл можно получить проведя обычную
сборку и запустив анализ графа по [инструкции](/src/dep_graph/wiki/dep_graph.md). Файл `task-children.txt` будет
находиться в папке `src/dep_graph/text-files/`. Его необходимо скопировать в папку `poky/build/` перед началом сборки.

Учет детей задачи позволил сократить время сборки с 216m41,635s до 161m43,487s.

Патч: `add_task_children_to_weight.patch`.