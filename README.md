# **Instructions**
> Для образа потребуется не менее 90Gb памяти. Процесс сборки займёт более 2 часов.

> Для выполнения следующих шагов необходим `Docker` и `Docker compose v2`!

Необходимо клонировать репозиторий. Это можно выполнить следующей командой:
```
git clone https://github.com/moevm/os_profiling.git
```
Все дальнейшие шаги происходят в директории `src`.

- ### **Yocto**
    Для удобного взаимодействия был реализован скрипт `entrypoint.sh`, далее рассмотрим его функционал.
    1. Чтобы узнать какой функционал реализован в скрипте можно выполнить команду, после чего будет выведена информационная справка:
        ```
        ./entrypoint.sh
        ```
    
    2. Чтобы проверить установку всех необходимых зависимостей локально требуется выполнить команду:
        ```
        ./entrypoint.sh check
        ```
        
    3. Чтобы создать образ среды для проекта требуется выполнить команду:
        ```
        ./entrypoint.sh build_env
        ```
    
    4.  Чтобы получить доступ к файловой системе контейнера требуется выполнить команду:
        ```
        ./entrypoint.sh shell
        ```
    
    5.  Чтобы собрать образ Yocto требуется выполнить команду:
        ```
        ./entrypoint.sh build_yocto_image
        ```
        Когда произойдет автоматическое закрытие контейнера (с кодом 0) -- всё будет установлено. 

- ### **Работа с Yocto**
    Для авторизации в системе необходимо указать `login`, его значение `root`.
    Выход из системы осуществляется 2 способами:
    - `Ctrl + A`, + `X`
    - `Ctrl + A`, + `C`, + type `quit`
        
- ### **Логирование**
    В данный момент логирование предусмотерно только для **Yocto**.
    В скрипте `building.sh` реализован декоратор для предоставления возможности настройки логирования. Скрипт находится по пути `./assembly/scripts/building.sh`. Важно, что все команды позволяющие использовать утилиты для логирования необходимо выполнять строго под `sudo`.
    
    Для того, чтобы настроить и использовать нужные утилиты объявлены функции `function start_logging()` и `function finish_logging()`. Функции позволяют задавать необходимую реализацию логирования. Также в функции перёдаётся аргумент (`$1`) -- файл для логирования по умолчанию (`./assembly/logs/building_logs.txt`).
    
